<!DOCTYPE html>
<html lang="en">
<head>
 <title>Frederik Braun: On the X-Frame-Options Security Header</title>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
 <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 200"><style>svg{background-color:%231f54a6;}text{fill:white;font-family:Georgia,Cambria,"Times New Roman",Times,serif;}</style><text y="1.2em" font-size="135">F</text></svg>'>
 <link href="https://vaurenw.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Frederik Braun ATOM Feed" />
 <link href="https://vaurenw.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Frederik Braun RSS Feed" />
 <meta property="og:site_name" content="Frederik Braun"/>
 <meta property="og:type" content="website"/>
 <meta name="twitter:card" content="summary"/>
 <meta name="description" content="On the X-Frame-Options Security Header" />
 <meta property="og:title" content="On the X-Frame-Options Security Header"/>
 <meta property="og:url" content="https://vaurenw.github.io/x-frame-options-security-header.html"/>
 <meta name="twitter:title" content="On the X-Frame-Options Security Header" />
 <meta name="fediverse:author" content="@freddy@security.plumbing" />
 <link rel="canonical" href="https://vaurenw.github.io/x-frame-options-security-header.html"/>
</head>

<body>
<header class="site-header" role="banner">
<div class="wrapper"><a class="site-title" rel="author" href="/">Frederik Braun</a><nav class="site-nav">
  <input type="checkbox" id="nav-trigger" class="nav-trigger">
  <label for="nav-trigger">
  <span class="menu-icon">
    <svg viewBox="0 0 18 15" width="18px" height="15px">
      <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
    </svg>
  </span>
  </label>
  <div class="trigger">
    <a class="page-link" href="https://vaurenw.github.io/archives.html">Blog</a>
    <a class="page-link" href="https://vaurenw.github.io/pages/publications.html">Portfolio</a>
    <a class="page-link" href="https://vaurenw.github.io/contact.html">Contact</a>
</div>
</nav></div>
</header>

<hr class="tophr">
<div id='wrapper' class="wrapper">
<div id='text1'>
        
<header>
  <h1>On the X-Frame-Options Security Header</h1>
  <time datetime="2013-12-12T00:00:00+01:00">Thu 12 December 2013</time>
</header>
<article>
    <p>This blog post <em>about X-Frame-Options</em> was originally published on the <a href="https://blog.mozilla.org/security/2013/12/12/on-the-x-frame-options-security-header/">Mozilla Security Blog</a></p>
<p>A few weeks ago, <a href="http://heideri.ch/">Mario Heiderich</a> and I published a <a href="https://frederik-braun.com/xfo-clickjacking.pdf" title="X-Frame-Options: All about Clickjacking?">white paper</a> about the <a href="http://tools.ietf.org/html/rfc7034" title="RFC7034">X-Frame-Options security header</a>. In this blog post, I want to summarize the key arguments for settings this security header in your web application.</p>
<p>X-Frame-Options is an optional HTTP response header that was introduced in 2008 and found its first implementation in Internet Explorer 8. Setting this header in your web application defines if it works within a frame element (e.g., <code>iframe</code>). The syntax for this header provides three options, ALLOW-FROM, DENY or SAMEORIGIN. Not sending this header implies allowing frames in general. ALLOW-FROM, however, allows whitelisting a specific <a href="http://tools.ietf.org/html/rfc6454#section-3.2.1" title="An origin is the scheme, host and the (optional) port of a URI">origin</a>. The opposite is, of course, DENY which means that no website is ever allowed to display your website in a frame. A common middle ground is to send SAMEORIGIN. This means that only websites of the <a href="http://tools.ietf.org/html/rfc6454#section-3.2.1" title="Being same-origin means having the same scheme, host and port">same origin</a> may frame it.</p>
<p>This blog post will highlight some attacks than can be thwarted by forbidding the framing of your document. First of all, <strong>Clickjacking</strong>. This term has gained major attention in 2008 and includes a multitude of techniques in which an evil web page can secretly include yours in a frame. But the author of this evil website will make your website transparent and present buttons on top of it. Anyone visiting this evil page will then click on something seemingly unrelated, which will actually result in mouse clicks in your web application.</p>
<p>A wide class of attacks on other websites leverage missing security features in the browser. Most modern browsers provide hardened security mechanisms that may easily thwart problems with content injections. The problem lies, as so often, in <a href="http://msdn.microsoft.com/en-us/library/jj676915%28v=vs.85%29.aspx" title="Microsoft explains legacy document modes">backwards compatibility.</a> The most recent browser versions are obviously more secure than the previous ones. But when somebody frames your website, they can tell it to run in a <strong>compatibility mode</strong>. This feature only applies to Internet Explorer, but it will bring back the vintage rendering algorithms from IE7 (2006). In Internet Explorer, the <em>document mode</em> is inherited from the top window to all frames. If the evil websites runs in IE7 compatibility mode, then so does yours! This is an example of how IE7 compatibility can be triggered in any website:</p>
<p><code>&lt;meta http-equiv="X-UA-Compatible" content="IE=7" /&gt;</code></p>
<p>If your website would not allow to be framed, your IE users were not at risk.</p>
<p>Another technique for possible attackers comes with <strong>window.name</strong>. This attribute of your browsing window (a tab, a popup and a frame are all windows in JavaScript's sense) <strong>can be set by others</strong> and you cannot prevent it. The implications of this are manifold, but just for the sake of <a href="https://en.wikipedia.org/wiki/Cross-site_scripting" title="as explained in the Wikipedia"><strong>Cross-Site-Scripting</strong> (XSS)</a> attacks it may make things for an attacker much easier. Sometimes, when an attacker is able to inject and execute scripts on your web page, he might be hindered by a length restriction. Say, for example, your website does not allow names that exceed 80 characters. Or messages that must not exceed 140. The window.name property can help bypassing these restriction in a very easy way. The attacker can just <a href="#" title="I hope you notice a pattern here">frame your website </a>and give it a name of his liking, by supplying it in the frame's <code>name</code> attribute. The JavaScript he will then execute can be as short as <code>&lt;svg/onload=eval(name)&gt;</code>, which means that it will execute the JavaScript specified in the name attribute of the frame element.</p>
<p>These and <a href="https://frederik-braun.com/xfo-clickjacking.pdf" title="Interested? Read the full document.">many other attacks</a> are possible if you allow your web page to be displayed in a frame. Just recently, Isaac Dawson from Veracode has published a <a href="http://www.veracode.com/blog/2013/11/security-headers-on-the-top-1000000-websites-november-2013-report/">report about security headers</a> on the top 1 million websites, which shows, that only 30,000 of them currently supply this header. However, the fact that many other sites are vulnerable to these sort of attacks is not a good reason to leave your website unprotected. You can easily address many security problems by just adding this simple header to your web application right away: If you're using Django, check out the <a href="https://docs.djangoproject.com/en/dev/ref/clickjacking/#" title="Django X-Frame-Options">XFrameOptionsMiddleware</a>. For NodeJS applications, you can use the <a href="https://npmjs.org/package/helmet">helmet library</a> to add security headers. If you want to set this header directly from within Apache or nginx, just take a look at the <a href="https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options">X-Frame-Options article on MDN</a>.</p>
</article>

<hr>

<section id="minicontact">
<em>
<!-- Please comment on <a href="https://social.security.plumbing/@freddy">Mastodon</a>. -->
If you find a mistake in this article, you can <a href="https://github.com/freddyb/homepage/edit/main/content/xfo.md">submit a pull request on GitHub</a>.
</em>
</section>

<section id="article-list">
<h4>Recent posts</h4>
<ol>
  <li><a href="https://vaurenw.github.io/madweb-keynote-2025.html">With Carrots & Sticks - Can the browser handle web security?</a>
    <em>(Tue 08 April 2025)</em>
  </li>
  <li><a href="https://vaurenw.github.io/home-assistant-can-not-be-secured-for-internet-access.html">Home assistant can not be secured for internet access</a>
    <em>(Sun 15 December 2024)</em>
  </li>
  <li><a href="https://vaurenw.github.io/modern-solutions-xsleaks.html">Modern solutions against cross-site attacks</a>
    <em>(Tue 26 November 2024)</em>
  </li>
  <li><a href="https://vaurenw.github.io/prompt-injections-and-a-demo.html">Prompt Injections and a demo</a>
    <em>(Wed 18 September 2024)</em>
  </li>
  <li><a href="https://vaurenw.github.io/mozilla-monument.html">The Mozilla Monument in San Francisco</a>
    <em>(Fri 05 July 2024)</em>
  </li>
            
</ol>
</section>
</div>
</div>
</body>
</html>